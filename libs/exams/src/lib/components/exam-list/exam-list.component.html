<div class="exam-list-container">
  <nz-page-header class="site-page-header" nzTitle="Exams">
    <nz-page-header-extra>
      <nz-space-compact>
        @if (!isStudent) {
          <button nzInputAddonBefore nz-button nzType="primary" routerLink="form"> Add </button>
        }
        <nz-input-wrapper>
          <nz-icon nzInputSuffix nzType="search" />
          <input
            nz-input
            type="text"
            placeholder="Search"
            [(ngModel)]="searchText"
            (ngModelChange)="onSearchChange($event)"
          />
        </nz-input-wrapper>
      </nz-space-compact>
    </nz-page-header-extra>
  </nz-page-header>

  <nz-table #basicTable nzBordered [nzData]="examList() ?? []">
    <thead>
      <tr>
        <th>Name</th>
        <th>Subject</th>
        <th>Start On</th>
        <th>Durations</th>
        <th>Department</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      @for (data of basicTable.data; track data.id) {
        <tr>
          <td>{{ data?.name }}</td>
          <td>{{ data?.subject }}</td>
          <td>{{ data?.startOn | date: 'yyyy-mm-dd hh:mm' }}</td>
          <td>{{ data?.duration }} mins</td>
          <td>{{ data?.department }}</td>

          <td>
            @if (!isStudent) {
              <button
                nz-button
                nzType="default"
                nzSize="small"
                (click)="onChangeStatus(data?.id, data?.isActive)"
              >
                {{ data?.isActive ?? false | status }}
              </button>
            } @else {
              <div>{{ data?.isActive ?? false | status }}</div>
            }
          </td>

          <td>
            @if (isStudent) {
              <a
                nz-button
                nzType="text"
                nz-tooltip
                nzTooltipTitle="Take Exam"
                [routerLink]="[data?.id, 'take-exam']"
              >
                <i nz-icon nzType="folder-open" nzTheme="twotone" nzTwotoneColor="#fa541c"></i>
              </a>
            } @else {
              <button
                nz-button
                nzType="text"
                nz-tooltip
                nzTooltipTitle="Edit"
                [routerLink]="[data?.id, 'form']"
              >
                <i nz-icon nzType="edit" nzTheme="twotone" nzTwotoneColor="#faad14"></i>
              </button>

              <button
                nz-button
                nzType="text"
                nz-tooltip
                nzTooltipTitle="Delete"
                (click)="delete(data)"
              >
                <i nz-icon nzType="delete" nzTheme="twotone" nzTwotoneColor="#f5222d"></i>
              </button>

              <button
                nz-button
                nzType="text"
                nz-tooltip
                nzTooltipTitle="More"
                nz-dropdown
                [nzDropdownMenu]="menu"
              >
                <i nz-icon nzType="more" nzTheme="outline"></i>
              </button>

              <nz-dropdown-menu #menu="nzDropdownMenu">
                <ul nz-menu>
                  <li nz-menu-item>
                    <a style="color: #8c8c8c" [routerLink]="[data?.id, 'questions']">
                      Add Questions
                    </a>
                  </li>
                  <li nz-menu-item>
                    <a style="color: #8c8c8c" [routerLink]="[data?.id, 'takers']"> View Takers </a>
                  </li>
                </ul>
              </nz-dropdown-menu>
            }
          </td>
        </tr>
      }
    </tbody>
  </nz-table>
</div>
